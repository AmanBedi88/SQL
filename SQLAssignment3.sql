---- CREATE DATABASE----
CREATE DATABASE SFDC_UNIVERSITY;

USE SFDC_UNIVERSITY;

---CREATE TABLES---
CREATE TABLE COLLEGE_TABLE 
(COLLEGE_ID VARCHAR(15) PRIMARY KEY,
COLLEGE_NAME VARCHAR(255) NOT NULL,
COLLEGE_AREA VARCHAR( 255) NOT NULL);

CREATE TABLE DEPARTMENT_TABLE
(DEPT_ID VARCHAR(15) PRIMARY KEY,
DEPT_NAME VARCHAR(255) NOT NULL,
DEPT_FACILITY VARCHAR(255) NOT NULL);

CREATE TABLE PROFESSOR_TABLE
(PROFESSOR_ID VARCHAR(15) PRIMARY KEY,
PROFESSOR_NAME VARCHAR(255),
PROFESSOR_SUBJECT VARCHAR(255));

CREATE TABLE STUDENT_TABLE
(STUDENT_ID VARCHAR(15) PRIMARY KEY,
STUDENT_NAME VARCHAR(255),
STUDENT_STREAM VARCHAR(255));

---- Apply foreign key on Department key from College_table ----
ALTER TABLE DEPARTMENT_TABLE ADD COLLEGE_ID VARCHAR(15);
ALTER TABLE DEPARTMENT_TABLE ADD FOREIGN KEY (COLLEGE_ID) REFERENCES COLLEGE_TABLE(COLLEGE_ID);

---- Apply foreign Key on Student_Table from Professor_Table ----
ALTER TABLE STUDENT_TABLE ADD PROFESSOR_ID VARCHAR(15);
ALTER TABLE STUDENT_TABLE ADD FOREIGN KEY (PROFESSOR_ID) REFERENCES PROFESSOR_TABLE(PROFESSOR_ID);

---CONNECT PROFESSOR TABLE & DEPARTMENT TABLE---
ALTER TABLE PROFESSOR_TABLE ADD DEPT_ID VARCHAR(15);
ALTER TABLE PROFESSOR_TABLE ADD FOREIGN KEY (DEPT_ID) REFERENCES DEPARTMENT_TABLE(DEPT_ID);
ALTER TABLE DEPARTMENT_TABLE DROP COLUMN DEPT_FACILITY;

---Insert atleast 10 Records in COLLEGE_TABLE  table----
INSERT INTO COLLEGE_TABLE VALUES
('C_001','DAV','JALANDHAR'),
('C_002','LIT','PHAGWARA'),
('C_003','AMITY','NOIDA'),
('C_004','RYAN','GURGAON'),
('C_005','MANIPAL','MANGALORE'),
('C_006','CHITKARRA','CHANDIGARH'),
('C_007','ISB','HYDERABAD'),
('C_008','BITS','GOA'),
('C_009','CT','JALANDHAR'),
('C_010','BITS','PILANI');

INSERT INTO DEPARTMENT_TABLE VALUES
('D_001','ENGINEERING','C_001'),
('D_002','MANAGEMENT','C_001'),
('D_003','PHARMA','C_001'),
('D_004','ENGINEERING','C_002'),
('D_005','PHARMA','C_002'),
('D_006','MANAGEMENT','C_003'),
('D_007','PHARMA','C_004'),
('D_008','MANAGEMENT','C_005'),
('D_009','MANAGEMENT','C_006'),
('D_010','MANAGEMENT','C_007'),
('D_011','PHARMA','C_009'),
('D_012','ENGINEERING','C_008'),
('D_013','ENGINEERING','C_010');

INSERT INTO PROFESSOR_TABLE VALUES
('P_001','JOHN','JAVA','D_001'),
('P_002','MOHIT','POWER BI','D_002'),
('P_003','LISA','BIO','D_003'),
('P_004','ANMOL','DAA','D_004'),
('P_005','RYAN','CHEMISTRY','D_005'),
('P_006','RICHARD','ECONOMICS','D_006'),
('P_007','ELI','BIO','D_007'),
('P_008','DAVO','MARKETING','D_008'),
('P_009','AMAN','FINNACE','D_009'),
('P_010','ANIKET','MARKETING','D_010'),
('P_011','MATT','CHEMISTRY','D_011'),
('P_012','ARVIND','SQL','D_012'),
('P_013','DAVID','SQL','D_013');

INSERT INTO STUDENT_TABLE VALUES
('S_001','AMAN','CSE','P_001'),
('S_002','BHUPINDER','FINANCE','P_002'),
('S_003','JAI','BPHARMA','P_003'),
('S_004','INDER','ECE','P_004'),
('S_005','ABHI','BPHARMA','P_005'),
('S_006','RASHIM','MARKETING','P_006'),
('S_007','SONIA','MPHARMA','P_007'),
('S_008','HARDEEP','FINANCE','P_008'),
('S_009','PANKAJ','OPERATIONS','P_009'),
('S_010','NITIN','MARKETING','P_010'),
('S_011','AMAN','MPHARMA','P_010'),
('S_012','ARVIND','MECHNICAL','P_012'),
('S_013','DEEPIKA','IT','P_013');

----Give the information of College_ID and College_name from College_Table ----
SELECT COLLEGE_ID,COLLEGE_NAME FROM COLLEGE_TABLE;

----Show  Top 5 rows from Student table-----
SELECT TOP 5 * FROM STUDENT_TABLE;

----What is the name of  professor  whose ID  is 5 ---
SELECT PROFESSOR_NAME FROM PROFESSOR_TABLE WHERE PROFESSOR_ID='P_005';

---- Convert the name of the Professor into Upper case-----
SELECT UPPER(PROFESSOR_NAME) AS PROFESSOR_NAME FROM PROFESSOR_TABLE;

----Show me the names of those students whose name is start with a----
SELECT STUDENT_NAME FROM STUDENT_TABLE WHERE STUDENT_NAME LIKE 'A%';

---- Give the name of those colleges whose end with a ----
SELECT COLLEGE_NAME FROM COLLEGE_TABLE WHERE COLLEGE_NAME LIKE '%A';

----Add one Salary Column in Professor_Table----
ALTER TABLE PROFESSOR_TABLE ADD SALARY NUMERIC;
SELECT * FROM PROFESSOR_TABLE;

----Add one Contact Column in Student_table----
ALTER TABLE STUDENT_TABLE ADD CONTACT VARCHAR(50);

----Change datatype of any one column of any one Table---
ALTER TABLE PROFESSOR_TABLE ALTER COLUMN PROFESSOR_SUBJECT CHAR(25);

---Show first 5 records from Students table and Professor table Combine---
SELECT TOP 5 S.*, P.* FROM STUDENT_TABLE S JOIN PROFESSOR_TABLE P ON S.PROFESSOR_ID=P.PROFESSOR_ID;

---- Apply Inner join on all 4 tables together----
SELECT * FROM DEPARTMENT_TABLE;
SELECT C.*, D.*,P.*, S.* FROM (((STUDENT_TABLE S JOIN PROFESSOR_TABLE P ON S.PROFESSOR_ID =P.PROFESSOR_ID)
JOIN DEPARTMENT_TABLE D ON P.DEPT_ID=D.DEPT_ID)
JOIN COLLEGE_TABLE C ON C.COLLEGE_ID=D.COLLEGE_ID);

----Show Some null values from Department table and Professor table----
SELECT D.*, P.* FROM DEPARTMENT_TABLE D FULL OUTER JOIN PROFESSOR_TABLE P ON D.DEPT_ID=P.DEPT_ID;

---Create a View from College Table  and give those records whose college name starts with C ----
CREATE VIEW COLG_NAME_C AS (SELECT COLLEGE_ID,COLLEGE_NAME FROM COLLEGE_TABLE WHERE COLLEGE_NAME LIKE 'C%');

----Create Stored Procedure  of Professor table whatever customer ID will be given by user it should show whole records of it. ----
CREATE PROCEDURE PROD_PROFESSOR_CUST @CUSTOMER_ID VARCHAR(15)=NULL AS
BEGIN
SELECT * FROM PROFESSOR_TABLE WHERE PROFESSOR_ID=@CUSTOMER_ID
END
GO

EXEC PROD_PROFESSOR_CUST @CUSTOMER_ID='P_001';

----Rename the College_Table to College_Tables_Data----
SELECT * FROM COLLEGE_TABLE;
EXEC sp_rename 'COLLEGE_TABLE','COLLEGE_TABLES_DATA';